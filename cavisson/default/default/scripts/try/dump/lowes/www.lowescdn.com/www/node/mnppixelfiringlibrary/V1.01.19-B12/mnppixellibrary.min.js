!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).MNPPixelFiring={})}(this,(function(t){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r="__lodash_hash_undefined__",n="[object Function]",o="[object GeneratorFunction]",i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/,c=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,u=/\\(\\)?/g,s=/^\[object .+?Constructor\]$/,d="object"==typeof e&&e&&e.Object===Object&&e,p="object"==typeof self&&self&&self.Object===Object&&self,f=d||p||Function("return this")();var y,h=Array.prototype,v=Function.prototype,g=Object.prototype,_=f["__core-js_shared__"],b=(y=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||""))?"Symbol(src)_1."+y:"",x=v.toString,m=g.hasOwnProperty,w=g.toString,$=RegExp("^"+x.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),T=f.Symbol,j=h.splice,O=U(f,"Map"),P=U(Object,"create"),S=T?T.prototype:void 0,I=S?S.toString:void 0;function k(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function C(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function A(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function D(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}function E(t,e){for(var r,n=0,o=(e=function(t,e){if(Y(t))return!1;var r=typeof t;if("number"==r||"symbol"==r||"boolean"==r||null==t||W(t))return!0;return a.test(t)||!i.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:Y(r=e)?r:R(r)).length;null!=t&&n<o;)t=t[q(e[n++])];return n&&n==o?t:void 0}function L(t){return!(!N(t)||(e=t,b&&b in e))&&(function(t){var e=N(t)?w.call(t):"";return e==n||e==o}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?$:s).test(function(t){if(null!=t){try{return x.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function M(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function U(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return L(r)?r:void 0}k.prototype.clear=function(){this.__data__=P?P(null):{}},k.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},k.prototype.get=function(t){var e=this.__data__;if(P){var n=e[t];return n===r?void 0:n}return m.call(e,t)?e[t]:void 0},k.prototype.has=function(t){var e=this.__data__;return P?void 0!==e[t]:m.call(e,t)},k.prototype.set=function(t,e){return this.__data__[t]=P&&void 0===e?r:e,this},C.prototype.clear=function(){this.__data__=[]},C.prototype.delete=function(t){var e=this.__data__,r=D(e,t);return!(r<0)&&(r==e.length-1?e.pop():j.call(e,r,1),!0)},C.prototype.get=function(t){var e=this.__data__,r=D(e,t);return r<0?void 0:e[r][1]},C.prototype.has=function(t){return D(this.__data__,t)>-1},C.prototype.set=function(t,e){var r=this.__data__,n=D(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},A.prototype.clear=function(){this.__data__={hash:new k,map:new(O||C),string:new k}},A.prototype.delete=function(t){return M(this,t).delete(t)},A.prototype.get=function(t){return M(this,t).get(t)},A.prototype.has=function(t){return M(this,t).has(t)},A.prototype.set=function(t,e){return M(this,t).set(t,e),this};var R=F((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(W(t))return I?I.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var r=[];return c.test(t)&&r.push(""),t.replace(l,(function(t,e,n,o){r.push(n?o.replace(u,"$1"):e||t)})),r}));function q(t){if("string"==typeof t||W(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function F(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(F.Cache||A),r}F.Cache=A;var Y=Array.isArray;function N(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function W(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==w.call(t)}var G=function(t,e,r){var n=null==t?void 0:E(t,e);return void 0===n?r:n},Z={criteo:"https://d.us.criteo.com/delivery/adserving",citrus:"https://lowes.citruserve.com/v1/resource/third-o"},z={OCP:{eventType:"trackTransaction",pageID:{desktop:"trackTransaction_API_desktop",mobile:"trackTransaction_API_mobile"}},PDP:{eventType:"viewItem",pageID:{desktop:"viewItem_API_desktop",mobile:"viewItem_API_mobile"}}},H={criteo:{"criteo-partner-id":"75776",nocall:"cd"},citrus:{key:"pk_UWnJcavnSC51cqgovUlzNWRRV28xZmUwNWRhMy1iNWRmLTQ1ZGYtYThkMS1hMjFmMTJkOTU4YzY=",teaid:"1fe05da3-b5df-45df-a8d1-a21f12d958c6",catid:"29ae4d5c-4453-47bf-8171-d9abb50c75cb"}};const J=()=>{try{return"desktop"===dataLayer.page.pageInfo.siteID?"d":"m"}catch(t){return""}};const B=t=>{let e=0;for(let r=0;r<t.length;r+=1){e=(e<<5)-e+t.charCodeAt(r),e&=e}return Math.abs(e)},Q=()=>{const t=function(t,e){if(void 0===e&&(e=decodeURIComponent),"string"!=typeof t||!t)return null;var r=new RegExp("(?:^|; )"+t.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")+"(?:=([^;]*))?(?:;|$)").exec(document.cookie);return null===r?null:"function"==typeof e?e(r[1]):r[1]}("dbidv2");return B(t||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})))},V=()=>{var t,e,r;let n=0;var o,i;"undefined"!=typeof dataLayer&&null!==(t=dataLayer)&&void 0!==t&&t.products&&null!==(e=dataLayer.products[0])&&void 0!==e&&null!==(r=e.attributes)&&void 0!==r&&r.availability&&Object.values(null===(o=dataLayer.products[0])||void 0===o||null===(i=o.attributes)||void 0===i?void 0:i.availability).forEach((t=>{null!=t&&t.isAvlSts&&(n=1)}));return n},{dataLayer:X}=window,K={...H.criteo,"retailer-visitor-id":Q(),environment:J()},tt={...H.citrus,ordts:(()=>{const t=new Date;return`${t.getUTCFullYear().toString()}-${(t.getUTCMonth()+1).toString().padStart(2,"0")}-${t.getUTCDate().toString().padStart(2,"0")}T${t.getUTCHours().toString().padStart(2,"0")}:${t.getUTCMinutes().toString().padStart(2,"0")}:${t.getUTCSeconds().toString().padStart(2,"0")}Z`})(),sesid:Q()},et=t=>{var e,r,n,o,i,a,c;const l={criteo:{productDisplay:{...K,item:void 0!==X&&(null==X||null===(e=X.products)||void 0===e||null===(r=e[0])||void 0===r||null===(n=r.productInfo)||void 0===n?void 0:n.productID)||"",price:void 0!==X&&(null==X||null===(o=X.products)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.attributes.sellingPrice)||"",availability:V(),"page-id":"d"===J()?z.PDP.pageID.desktop:z.PDP.pageID.mobile,"event-type":z.PDP.eventType},orderConfirmation:{...K,"transaction-id":void 0!==X&&(null==X||null===(a=X.transaction)||void 0===a?void 0:a.transactionID)||"","page-id":"d"===J()?z.OCP.pageID.desktop:z.OCP.pageID.mobile,"event-type":z.OCP.eventType}},citrus:{orderConfirmation:{...tt,ordid:void 0!==X&&(null==X||null===(c=X.transaction)||void 0===c?void 0:c.transactionID)||""}}};return G(l,t)};const rt=t=>{try{!function(){const t="keepalive"in new Request("");return"fetch"in window&&t}()?function(t){const e=new XMLHttpRequest;e.open("GET",t,!0),e.send()}(t):function(t){fetch(t,{mode:"no-cors",keepalive:!0})}(t)}catch(t){console.error(t)}},nt=()=>{const t=`${Z.criteo}${(()=>{const t=et("criteo.productDisplay");let e="?";return Object.keys(t).forEach((r=>{e+=`${r}=${t[r]}&`})),e=e.slice(0,-1),e})()}`;rt(t)},ot=()=>{var t;const{dataLayer:e}=window,r=void 0!==e&&(null==e||null===(t=e.transaction)||void 0===t?void 0:t.items)||[],n=[],o=[],i=[];return r.forEach((t=>{n.push(null==t?void 0:t.productID),o.push(null==t?void 0:t.unitPrice),i.push(null==t?void 0:t.quantity)})),{items:n,prices:o,quantities:i}},it=()=>{const{items:t,prices:e,quantities:r}=ot(),n=`${Z.citrus}${((t,e,r)=>{const n=et("citrus.orderConfirmation");let o="?";return Object.keys(n).forEach((t=>{o+=`${t}=${n[t]}&`})),t&&Array.isArray(t)&&t.length>0&&e&&Array.isArray(e)&&e.length>0&&r&&Array.isArray(r)&&r.length>0&&t.length===e.length&&t.length===r.length&&(t.forEach((t=>{o+=`procods=${t}&`})),e.forEach((t=>{o+=`pris=${t}&`})),r.forEach((t=>{o+=`quas=${t}&`}))),o=o.slice(0,-1),o})(t,e,r)}`;rt(n)},at=()=>{const{items:t,prices:e,quantities:r}=ot(),n=`${Z.criteo}${((t,e,r)=>{const n=et("criteo.orderConfirmation");t&&Array.isArray(t)&&t.length>0&&e&&Array.isArray(e)&&e.length>0&&r&&Array.isArray(r)&&r.length>0&&t.length===e.length&&t.length===r.length&&(n.item=t.toString().replace(/,/gi,"|"),n.price=e.toString().replace(/,/gi,"|"),n.quantity=r.toString().replace(/,/gi,"|"));let o="?";return Object.keys(n).forEach((t=>{o+=`${t}=${n[t]}&`})),o=o.slice(0,-1),o})(t,e,r)}`;rt(n)},ct=(()=>{if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")})(),lt=t=>{if(!t)throw new Error("dataLayer object is required.");const e=(t=>{var e,r;return(null==t||null===(e=t.page)||void 0===e||null===(r=e.category)||void 0===r?void 0:r.pageType)||""})(t);if(!e)throw new Error("pageType is missing from the dataLayer object.");((t,e)=>{t.dataLayer=e})(ct,t),"product-display"===e?nt():"order_confirmation"===e&&(at(),it())};ct.addEventListener("mnpPixelFiringEvent",(t=>{const e=t.detail;lt(e)})),t.fireBeaconURL=t=>{const e=(t=>"string"!=typeof t||-1===t.toLowerCase().indexOf("display_")||-1===t.toLowerCase().indexOf("citrus")?t:((t,e,r)=>{let n=t.length,o="";t.indexOf("#")>0&&(n=t.indexOf("#"),o=t.substring(t.indexOf("#"),t.length));const i=t.substring(0,n).split("?");let a="";return i.length>1&&i[1].split("&").forEach((t=>{const r=t.split("=");r[0]!==e&&(""===a?a="?":a+="&",a+=`${r[0]}=${r[1]?r[1]:""}`)})),""===a&&(a="?"),""!==a&&"?"!==a&&(a+="&"),a+=`${e}=${r||""}`,i[0]+a+o})(t,"sessionId",Q()))(t);rt(e)},t.fireDataPixel=lt,Object.defineProperty(t,"__esModule",{value:!0})}));