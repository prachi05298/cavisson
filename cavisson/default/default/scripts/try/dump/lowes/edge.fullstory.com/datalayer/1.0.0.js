window.fsDataLayer=(()=>{"use strict";var e={608:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(378),o=r(712),s=r(645);t.DataLayerObserver=class{constructor(e,t,r){this.target=e,this.property=t,this.page=r,this.operators=[],e?this.start():s.Logger.error(s.LogEventType.DATALAYER_UNAVAILABLE,t)}emit(){this.handleEvent(new CustomEvent(o.ObjectEventType.PROPERTY,{detail:new o.ChangeEvent(this.target,this.property,this.target[this.property])}))}handleEvent(e){if(!this.page||RegExp(this.page).test(window.location.href))if(e.detail){const t=e,{args:r,value:n,target:o,property:s}=t.detail,a=n?[n]:r;o===this.target&&s===this.property&&a&&this.handleData(a)}else{e.target===this.target&&this.handleData([e])}}handleData(e){for(let t=0;t<this.operators.length;t++)try{if(null===e)return null;e=this.operators[t](e)}catch(e){s.Logger.error(s.LogEventType.OPERATOR_EXCEPTION,this.property,e.message)}return e}pipe(...e){e.forEach(e=>this.operators.push(e))}start(){this.type="function"==typeof this.target[this.property]?o.ObjectEventType.FUNCTION:o.ObjectEventType.PROPERTY,this.objectListener=new n.ShimListener(this.target,this.property),window.addEventListener(this.type,this)}stop(){this.objectListener&&this.objectListener.remove(),window.removeEventListener(this.type,this)}}},378:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(712),o=r(645);t.ShimListener=class{constructor(e,t){this.target=e,this.property=t,this.state={},e?(this.cloneProperty(this.property),"function"==typeof e[t]?this.createFunctionMonitor():this.createPropertyMonitor()):o.Logger.error(o.LogEventType.DATALAYER_UNAVAILABLE,t)}createPropertyMonitor(){try{Object.defineProperty(this.target,this.property,{enumerable:!0,get:()=>this.state[this.property].value,set:e=>{try{if(Array.isArray(e)&&Array.isArray(this.state[this.property].value)){if(e.length-this.state[this.property].value.length>0){e.slice(this.state[this.property].value.length).forEach(e=>window.dispatchEvent(new CustomEvent(n.ObjectEventType.PROPERTY,{detail:new n.ChangeEvent(this.target,this.property,e)})))}}else window.dispatchEvent(new CustomEvent(n.ObjectEventType.PROPERTY,{detail:new n.ChangeEvent(this.target,this.property,e)}))}catch(e){o.Logger.error(o.LogEventType.EMIT_FAILURE,this.property,e.message)}finally{this.state[this.property].value=e}}})}catch(e){o.Logger.error(o.LogEventType.MONITOR_FAILURE,this.property,e.message)}}createFunctionMonitor(){try{this.target[this.property]=(...e)=>{try{try{window.dispatchEvent(new CustomEvent(n.ObjectEventType.FUNCTION,{detail:new n.FunctionEvent(this.target,this.property,e)}))}catch(e){o.Logger.error(o.LogEventType.EMIT_FAILURE,this.property,e.message)}finally{return this.state[this.property].value.apply(this.target,e)}}catch(e){return o.Logger.error(o.LogEventType.DATALAYER_EXCEPTION,this.property,e.message),null}}}catch(e){o.Logger.error(o.LogEventType.MONITOR_FAILURE,this.property,e.message)}}cloneProperty(e){const t=this.target[e];this.state[e]={property:e,value:t}}remove(){try{"function"!=typeof this.target[this.property]?(delete this.target[this.property].get,delete this.target[this.property].set):this.target[this.property]=this.state[this.property].value}catch(e){o.Logger.error(o.LogEventType.REMOVAL_FAILURE,this.property,e.message)}}}},961:function(e,t,r){var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(608),s=r(755),a=r(645),i=n(r(546)),c=r(546);class u{constructor(e={rules:[],previewMode:!1,readOnLoad:!1}){this.options=e,this.observers=[];const{rules:t}=e;t&&t.forEach(e=>this.register(e))}observe(e,t){const r=new o.DataLayerObserver(e,t);return this.observers.push(r),r}getOperator(e){switch(e){case"api":return i.func;case"elementAt":return i.elementAt;case"first":return i.first;case"last":return i.last;case"name":return i.prepend;case"toBool":return i.toBool;case"toInt":return i.toInt;case"toReal":return i.toReal;case"toString":return i.toString;case"filter":return i.filter;case"flatten":return i.flatten;case"pick":return i.pick;case"pluck":return i.pluck;case"suffix":return i.suffix;default:return null}}register(e){const{previewMode:t,readOnLoad:r}=this.options,{source:n,operators:i,destination:u,maxDepth:p,readOnLoad:l,page:f}=e,y=l||r;try{const e=n.split("."),r=1===e.length?window:s.traverseObject(window,e.slice(0,e.length-1)),l=1===e.length?e[0]:e[e.length-1];if(r&&l&&r[l]){const e=new o.DataLayerObserver(r,l,f);if(i)for(let t=0;t<i.length;t++){const[r]=Object.keys(i[t]),o=i[t][r],s="string"==typeof o?o.split("|"):[o],c=this.getOperator(r);c?e.pipe(c.apply(null,s)):(e.pipe(()=>null),a.Logger.error(a.LogEventType.RULE_FAILURE,n,`Operator ${r} not found`))}u&&(t?e.pipe(c.suffix(p),c.func("console.log")):e.pipe(c.suffix(p),c.func(u))),this.observers.push(e),y&&"function"!=typeof l&&e.emit()}else a.Logger.error(a.LogEventType.DATALAYER_UNAVAILABLE,n)}catch(e){a.Logger.error(a.LogEventType.RULE_FAILURE,n,e.message)}}}t.DataLayer=u,u.version="1.0.0"},712:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PROPERTY="_fs_datalayerProperty",e.FUNCTION="_fs_datalayerFunction"}(t.ObjectEventType||(t.ObjectEventType={}));class r{constructor(e,t){this.target=e,this.property=t}}t.ObjectEvent=r;t.ChangeEvent=class extends r{constructor(e,t,r){super(e,t),this.value=r}};t.FunctionEvent=class extends r{constructor(e,t,r){super(e,t),this.args=r}}},607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(961),o=window;function s(e){return o.fsDataLayer=e?new n.DataLayer(e):new n.DataLayer({previewMode:o._fs_datalayer_preview,readOnLoad:o._fs_datalayer_read_onload,rules:o._fs_datalayer_rules}),o.fsDataLayer}if(t.init=s,o[o._fs_namespace])s();else{const e=o._fs_ready;o._fs_ready=()=>{s(),e&&e()}}},361:(e,t)=>{function r(e){return t=>{const r=e>-1?e:t.length-1;return Array.isArray(t[r])?t[r]:[t[r]]}}Object.defineProperty(t,"__esModule",{value:!0}),t.elementAt=r,t.first=function(){return r(0)},t.last=function(){return r(-1)}},355:(e,t)=>{function r(e,t,r=0){return n=>{let o=[];return t?(o="string"==typeof t?t.split(","):t,o="*"===o[0]?Object.getOwnPropertyNames(n[r]):o):o=Object.getOwnPropertyNames(n[r]),o.forEach(t=>n[r][t]=function(e,t){switch(e){case"bool":return new Boolean(t).valueOf();case"int":return parseInt(t);case"real":return parseFloat(t);case"string":switch(typeof t){case"boolean":return new Boolean(t).toString();case"number":return t.toString()}}return t}(e,n[r][t])),n}}Object.defineProperty(t,"__esModule",{value:!0}),t.convert=r,t.toBool=function(e,t=0){return r("bool",e,t)},t.toInt=function(e,t=0){return r("int",e,t)},t.toReal=function(e,t=0){return r("real",e,t)},t.toString=function(e,t=0){return r("string",e,t)}},342:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filter=function(e,t,r=0){return n=>t&&n[r][e]!=t?null:void 0!==n[r][e]?n:null}},637:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.flatten=function(e=0){return t=>(t[e]=function e(t,r){return r||(r=t,t={}),Object.getOwnPropertyNames(r).forEach(n=>{"object"==typeof r[n]&&null!=r[n]?e(t,r[n]):t[n]=r[n]}),t}(t[e]),t)}},543:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(755),o=r(645);t.func=function(e,t){return r=>{switch(typeof e){case"function":t?e.apply(t,r):(o.Logger.warn(o.LogEventType.INCORRECT_ARGUMENTS),console.warn(`Datalayer function ${e} requires thisArg.`));break;case"string":const s=e.split("."),a=n.traverseObject(window,s);t=n.traverseObject(window,s.slice(0,s.length-1)),a.apply(t,r);break;default:o.Logger.warn(o.LogEventType.UNKNOWN_INPUT),console.warn(`Datalayer function ${e} not found.`)}return r}}},546:(e,t,r)=>{function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(361)),n(r(409)),n(r(355)),n(r(342)),n(r(637)),n(r(543)),n(r(388)),n(r(599)),n(r(409)),n(r(512))},388:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pick=function(e,t=0){return r=>{e="string"==typeof e?e.split(","):e;const n={};return e.forEach(e=>n[e]=!0),r[t]=function e(t,r){const n={};return Object.getOwnPropertyNames(t).forEach(o=>{r[o]&&("object"==typeof t[o]&&null!=t[o]?n[o]=e(t[o],r):n[o]=t[o])}),n}(r[t],n),r}}},599:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(755);t.pluck=function(e,t=0){return r=>(r[t]=n.traverseObject(r[t],e.split(".")),void 0!==r[t]?r:null)}},409:(e,t)=>{function r(e,t){const r=void 0===t[e]?e:t[e];return"string"==typeof r?r:e}Object.defineProperty(t,"__esModule",{value:!0}),t.prepend=function(e){return t=>[r(e,t[0]),...t]}},512:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(435);t.suffix=function(e=0){return t=>{for(let r=0;r<t.length;r++)"object"==typeof t[r]&&(t[r]=n.mapToSuffix(t[r],e>0,e));return t}}},645:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(26);!function(e){e.DATALAYER_EXCEPTION="Datalayer Exception",e.DATALAYER_UNAVAILABLE="Datalayer Unavailable",e.EMIT_FAILURE="Emit Failure",e.OPERATOR_EXCEPTION="Operator Exception",e.INCORRECT_ARGUMENTS="Incorrect Arguments",e.MONITOR_FAILURE="Monitor Failure",e.REMOVAL_FAILURE="Removal Failure",e.RULE_FAILURE="Rule Failure",e.UNKNOWN_INPUT="Unknown Input"}(t.LogEventType||(t.LogEventType={}));class o{static getLogEvent(e,t,r="error",n){return{datalayer_str:t,message_str:n,level_str:r,type_str:e}}static error(e,t,r){const s=n.getBrowserApi();s?s.event(o.NAME,this.getLogEvent(e,t,"error",r),o.SOURCE):console.error(e)}static warn(e,t=""){const r=n.getBrowserApi();r?r.event(o.NAME,this.getLogEvent(e,t,"warn"),o.SOURCE):console.warn(e)}}t.Logger=o,o.NAME="Datalayer Log",o.SOURCE="fsDataLayer"},755:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.traverseObject=function e(t,r){if(0===r.length)return t;{const n=t[r[0]];return n?e(n,r.slice(1)):void 0}}},435:(e,t)=>{var r;function n(e){return e%1==0?r.Int:r.Real}function o(e){if(Array.isArray(e)){if(e.every(e=>"string"==typeof e))return r.Strings;if(e.every(e=>"boolean"==typeof e))return r.Bools;if(e.every(e=>"number"==typeof e))return 0===e.filter(e=>"_real"===n(e)).length?r.Ints:r.Reals;if(e.every(e=>e instanceof Date))return r.Dates;if(e.every(e=>"object"==typeof e))return r.Objs}if(e instanceof Date)return r.Date;switch(typeof e){case"string":return r.String;case"boolean":return r.Bool;case"number":return n(e);case"object":return r.Obj;default:return""}}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Bool="_bool",e.Bools="_bools",e.Date="_date",e.Dates="_dates",e.Int="_int",e.Ints="_ints",e.Obj="_obj",e.Objs="_objs",e.String="_str",e.Strings="_strs",e.Real="_real",e.Reals="_reals"}(r=t.Suffixes||(t.Suffixes={})),t.coerceSuffix=o,t.mapToSuffix=function e(t,n=!1,s=1,a=0){const i={};return null==t||Object.getOwnPropertyNames(t).forEach(c=>{const u=t[c],p=o(u),l=`${c}${p}`;if(p)switch(p){case r.Obj:n&&a<s&&(i[l]=e(u,n,s,a+1));break;case r.Objs:n&&a<s&&(i[l]=u.map(t=>e(t,n,s,a+1)));break;default:i[l]=u}}),i}},26:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserApi=function(){const e=window;return e[e._fs_namespace]}}},t={};return function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(607)})();